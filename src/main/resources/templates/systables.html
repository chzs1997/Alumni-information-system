<!DOCTYPE html>
<html>

<head>
    
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="description" content=""/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="robots" content="all,follow"/>

    <title>校友信息</title>



    <!-- global stylesheets -->
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet"/>
    <link rel="stylesheet" href="static/static/system/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="static/static/system/font-awesome-4.7.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="static/static/system/css/font-icon-style.css"/>
    <link rel="stylesheet" href="static/static/system/css/style.default.css" id="theme-stylesheet"/>


    <!-- Bootstrap CSS -->
    <link href="static/static/css/style_1.css" rel="stylesheet" type="text/css"/>

    <link rel="stylesheet" type="text/css" href="static/static/system/css/selectFilter.css" />

    <!--样式-->
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">

    <link rel="stylesheet" type="text/css" href="static/static/system/css/layout.css"/>

</head>

<body> 

<!--====================================================
                        PAGE CONTENT
======================================================-->
    <div class="page-content d-flex align-items-stretch">
        <!--***** SIDE NAVBAR *****-->
        <nav class="side-navbar">
            <div class="sidebar-header d-flex align-items-center">
                <div class="avatar"><img src="static/static/img/touxaing.jpg" alt="..." class="img-fluid rounded-circle"/></div>
                <div class="title">
                    <h1 class="h4" id = "username_navigator">无用户</h1>
                </div>
            </div>
            <hr/>
            <!-- Sidebar Navidation Menus-->
            <ul class="list-unstyled">
                <li> <a href="/sysindex"><i></i>数据报表</a></li>
                <li><a href="sysbasic-form.html"> <i></i>新闻编辑</a></li>
                <li  class="active"> <a href="systables.html"> <i></i>校友信息</a></li>
                <li> <a href="sysStroke.html"> <i></i>校友行程</a></li>
            </ul>
        </nav>

        <div class="content-inner chart-cont">
            <div class="item" >
                <!-- 这里开始 -->
                <div style = "float:left ">年级:</div>
                <div class="filter-box" id = "fi1" style = "float:left;margin-left:15px">
                    <div class="filter-text">
                        <input class="filter-title" type="text" readonly placeholder="pleace select" id = "gradeSelected"/>
                        <i class="icon icon-filter-arrow"></i>
                    </div>
                    <select name="filter">
                        <option value="请选择" selected>请选择</option>
                        <option value="2018级">2018级</option>
                        <option value="2017级">2017级</option>
                        <option value="2016级">2016级</option>
                        <option value="2015级">2015级</option>
                        <option value="2014级">2014级</option>
                        <option value="2013级">2013级</option>
                        <option value="2012级">2012级</option>
                        <option value="2011级">2011级</option>
                        <option value="2010级">2010级</option>
                        <option value="2009级">2009级</option>
                        <option value="2008级">2008级</option>
                        <option value="2007级">2007级</option>
                        <option value="2006级">2006级</option>
                    </select>
                </div>

                <div style = "float:left;margin-left:60px">专业:</div>
                <div class="filter-box" id = "fi2" style = "float:left;margin-left:15px">
                    <div class="filter-text">
                        <input class="filter-title" type="text" readonly placeholder="pleace select" id = "majorSelected"/>
                        <i class="icon icon-filter-arrow"></i>
                    </div>
                    <select name="filter">
                        <option value="请选择" selected>请选择</option>
                        <option value="信息管理与信息系统1班">信息管理与信息系统1班</option>
                        <option value="信息管理与信息系统2班">信息管理与信息系统2班</option>
                        <option value="数字出版">数字出版</option>
                        <option value="行政管理1班">行政管理1班</option>
                        <option value="行政管理2班">行政管理2班</option>
                        <option value="政治学与行政学">政治学与行政学</option>
                        <option value="公共事业管理">公共事业管理</option>
                        <option value="图书馆学1班">图书馆学1班</option>
                        <option value="图书馆学2班">图书馆学2班</option>
                        <option value="档案学">档案学</option>
                    </select>
                </div>

                <div style = "float:left;margin-left:60px">性别:</div>
                <div class="filter-box" id = "fi3" style = "float:left;margin-left:15px">
                    <div class="filter-text">
                        <input class="filter-title" type="text" readonly placeholder="pleace select" id = "genderSelected"/>
                        <i class="icon icon-filter-arrow"></i>
                    </div>
                    <select name="filter">
                        <option value="请选择" selected>请选择</option>
                        <option value="男">男</option>
                        <option value="女">女</option>
                    </select>
                </div>

                <button class="login-button"  id = "searchByconidition" style="margin-left: 30px;">查找</button>
                <button type="button" class="btn green" id="excell" onclick="bt()" style="margin-left: 30px;cursor: pointer">下载</button>

            </div>
            <!--***** CONTENT *****-->
            <section class="content">
                <div class="btn-group operation">
                    <button id="btn_add" type="button" class="btn bg-primary">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>新增
                    </button>
                    <button id="btn_edit" type="button" class="btn bg-info">
                        <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>修改
                    </button>
                    <button id="btn_delete" type="button" class="btn btn-success">
                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>删除
                    </button>
                </div>
                <div class="modal fade" id="addBook" role="dialog">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title">添加校友信息</h4>
                            </div>
                            <div id="addBookModal" class="modal-body">
                                <div class="form-horizontal">
                                    <div class="form-group">
                                        <label for="addUserName" class="col-sm-2 control-label">姓名:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserName" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addUserGender" class="col-sm-2 control-label">性别:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserGender" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addUserEducation" class="col-sm-2 control-label">学历:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserEducation" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addUserBirthPlace" class="col-sm-2 control-label">籍贯:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserBirthPlace" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addUserGrade" class="col-sm-2 control-label">年级:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserGrade" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addUserMajor" class="col-sm-2 control-label">专业:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserMajor" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addUserGraduateYear" class="col-sm-2 control-label">毕业年份:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserGraduateYear" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addHeadTeacher" class="col-sm-2 control-label">班主任:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addHeadTeacher" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addUserMail" class="col-sm-2 control-label">邮箱:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserMail" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addUserCompany" class="col-sm-2 control-label">工作单位:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserCompany" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addUserPosition" class="col-sm-2 control-label">工作职位:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserPosition" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addUserAddress" class="col-sm-2 control-label">工作地点:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserAddress" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="addUserContact" class="col-sm-2 control-label">联系方式:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="addUserContact" type="text">
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="modal-footer">
                                <div class="center-block">
                                    <button id="cancelAdd" type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                                    <button id="addBooksInfo" type="button" class="btn btn-success" data-dismiss="modal">保存</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal fade" id="editBookInfo" role="dialog">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title">修改校友信息</h4>
                            </div>
                            <div id="editBookModal" class="modal-body">
                                <div class="form-horizontal">
                                    <div class="form-group">
                                        <label for="editUserName" class="col-sm-2 control-label">姓名:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserName" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editUserGender" class="col-sm-2 control-label">性别:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserGender" type="text" placeholder="男/女">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editUserEducation" class="col-sm-2 control-label">学历:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserEducation" type="text" placeholder="本科/硕士/博士/院士">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editUserBirthPlace" class="col-sm-2 control-label">籍贯:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserBirthPlace" type="text" placeholder="湖南省湘潭市">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editUserGrade" class="col-sm-2 control-label">年级:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserGrade" type="text" placeholder="xxxx级">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editUserMajor" class="col-sm-2 control-label">专业:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserMajor" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editUserGraduateYear" class="col-sm-2 control-label">毕业年份:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserGraduateYear" type="text" placeholder="xxxx年">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editHeadTeacher" class="col-sm-2 control-label">班主任:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editHeadTeacher" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editUserMail" class="col-sm-2 control-label">邮箱:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserMail" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editUserCompany" class="col-sm-2 control-label">工作单位:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserCompany" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editUserPosition" class="col-sm-2 control-label">工作职位:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserPosition" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editUserAddress" class="col-sm-2 control-label">工作地点:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserAddress" type="text">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="editUserContact" class="col-sm-2 control-label">联系方式:*</label>
                                        <div class="col-sm-10">
                                            <input class="form-control" id="editUserContact" type="text">
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="modal-footer">
                                <div class="center-block">
                                    <button id="cancelEdit" type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                                    <button id="saveEdit" type="button" class="btn btn-success" data-dismiss="modal">保存</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal fade" id="deleteBook" role="dialog">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title">确认要删除吗？</h4>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                                <button id="delete" type="button" class="btn btn-danger" data-dismiss="modal">删除</button>
                            </div>
                        </div>
                    </div>
                </div>

                <table id="books" class="table table-striped table-bordered row-border hover order-column" cellspacing="0" width="100%">
                    <thead>
                    <tr>
                        <th>序号</th>
                        <th>姓名</th>
                        <th>性别</th>
                        <th>学历</th>
                        <th>籍贯</th>
                        <th>年级</th>
                        <th>专业</th>
                        <th>毕业年份</th>
                        <th>班主任</th>
                        <th>邮箱</th>
                        <th>工作单位</th>
                        <th>工作职位</th>
                        <th>工作地点</th>
                        <th>联系方式</th>
                    </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </section>
        </div>

    </div> 


<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/datatables/1.10.16/js/jquery.dataTables.js"></script>

<script type="text/javascript" src="static/static/system/js/selectFilter.js"></script>

<!--登录状态检查-->
<script src="static/static/js/system/userDetect.js"></script>

<script>

    var obj = window.document.location;
    var BASE_PATH = obj.href.substring(0, obj.href.indexOf(obj.pathname));
    var result = new Array();  //先声明一维
    $.ajax({
        url:BASE_PATH + "/user/selectAllUser",
        type: "post",
        dateType: "json",
        async: false,
        data: {},
        success: function f(data) {
            for(var k=0;k<data.length;k++){    //一维长度为i,i为变量，可以根据实际情况改变

                result[k]=new Array();  //声明二维，每一个一维数组里面的一个元素都是一个数组；

                for(var j=0;j<14;j++){   //一维数组里面每个元素数组可以包含的数量p，p也是一个变量；

                    result[k][j]="";    //这里将变量初始化，我这边统一初始化为空，后面在用所需的值覆盖里面的值
                }
            }
            for(var i=0;i<data.length;i++){
                result[i][0]=data[i].userId;
                result[i][1]=data[i].userName;
                result[i][2]=data[i].userGender;
                result[i][3]=data[i].userEducation;
                result[i][4]=data[i].userBirthPlace;
                result[i][5]=data[i].userGrade;
                result[i][6]=data[i].userMajor;
                result[i][7]=data[i].userGraduateYear;
                result[i][8]=data[i].userHeadTeacher;
                result[i][9]=data[i].userMail;
                result[i][10]=data[i].userCompany;
                result[i][11]=data[i].userPosition;
                result[i][12]=data[i].userAddress;
                result[i][13]=data[i].phone;
            }
        },
        error: function f(data) {
            alert("lose");
        }
    });
    var titles = ['序号','姓名', '性别', '学历', '籍贯', '年级','专业', '毕业年份', '班主任', '邮箱', '工作单位','工作职位','工作地点','联系方式']
    $(function () {
        var table = $('#books').DataTable({
            data: result,
            "pagingType": "full_numbers",
            "bSort": true,
            "language": {
                "sProcessing": "处理中...",
                "sLengthMenu": "显示 _MENU_ 项结果",
                "sZeroRecords": "没有匹配结果",
                "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                "sInfoPostFix": "",
                "sSearch": "搜索:",
                "sUrl": "",
                "sEmptyTable": "表中数据为空",
                "sLoadingRecords": "载入中...",
                "sInfoThousands": ",",
                "oPaginate": {
                    "sFirst": "首页",
                    "sPrevious": "上页",
                    "sNext": "下页",
                    "sLast": "末页"
                },
                "oAria": {
                    "sSortAscending": ": 以升序排列此列",
                    "sSortDescending": ": 以降序排列此列"
                }
            },
            "columnDefs": [{
                "searchable": false,
                "orderable": true,
                "targets": 0
            }],
            "order": [[1, 'asc']]
        });
        table.on('order.dt search.dt', function() {
            table.column(0, {
                search: 'applied',
                order: 'applied'
            }).nodes().each(function(cell, i) {
                cell.innerHTML = i + 1;
            });
        }).draw();

        $('#books tbody').on('click', 'tr', function () {
            if ( $(this).hasClass('selected') ) {
                $(this).removeClass('selected');
            }
            else {
                table.$('tr.selected').removeClass('selected');
                $(this).addClass('selected');
            }
        });

        $("#cancelAdd").on('click', function() {
            console.log('cancelAdd');
            $("#addBookModal").find('input').val('')
        })

        $("#addBooksInfo").on('click', function() {
            console.log('addBooksInfo');
            if ($("#addBookModal").find('input').val() !== '') {
                var addUserName = $("#addUserName").val();

                var addUserGender = $("#addUserGender").val();
                var addUserEducation = $("#addUserEducation").val();
                var addUserBirthPlace = $("#addUserBirthPlace").val();
                var addUserGrade = $("#addUserGrade").val();
                var addUserMajor = $("#addUserMajor").val();
                var addUserGraduateYear = $("#addUserGraduateYear").val();
                var addHeadTeacher = $("#addHeadTeacher").val();
                var addUserMail = $("#addUserMail").val();
                var addUserCompany = $("#addUserCompany").val();
                var addUserPosition = $("#addUserPosition").val();
                var addUserAddress = $("#addUserAddress").val();
                var addUserContact = $("#addUserContact").val();

                if(!addUserEducation in ('本科','硕士','博士','院士')){
                    alert("学历输入的格式有误");
                    event.stopPropagation();
                }
                else if(!checkMail(addUserMail)){
                    alert("邮箱格式错误");
                    event.stopPropagation();
                }
                else if(!phoneCheck(addUserContact)){
                    alert("联系方式格式错误");
                    event.stopPropagation();
                }
                else {
                    $.ajax({
                        url: BASE_PATH + "/user/addUserByManager",
                        type: "post",
                        dateType: "json",
                        async: false,
                        data: {
                            "userName": addUserName
                            , "userGender": addUserGender
                            , "userEducation": addUserEducation
                            , "userBirthPlace": addUserBirthPlace
                            , "userGrade": addUserGrade
                            , "userMajor": addUserMajor
                            , "userGraduateYear": addUserGraduateYear
                            , "userHeadTeacher": addHeadTeacher
                            , "userMail": addUserMail
                            , "userCompany": addUserCompany
                            , "userPosition": addUserPosition
                            , "userAddress": addUserAddress
                            , "phone": addUserContact
                        },
                        success: function f(data) {
                            console.log(data);
                        },
                        error: function f(data) {
                            alert("lose");
                        }
                    });
                    // var addBookInfos = [].concat(addUserName, addUserGender, addUserEducation, addUserBirthPlace, addUserGrade, addUserMajor, addUserGraduateYear, addHeadTeacher, addUserMail, addUserCompany, addUserPosition, addUserAddress,  addUserContact);
                    // for (var i = 0; i < addBookInfos.length; i++) {
                    //     if (addBookInfos[i] === '') {
                    //         alert(titles[i] + '内容不能为空')
                    //     }
                    // }
                    table.row.add(['', addUserName, addUserGender, addUserEducation, addUserBirthPlace, addUserGrade, addUserMajor, addUserGraduateYear, addHeadTeacher, addUserMail, addUserCompany, addUserPosition, addUserAddress, addUserContact]).draw();
                    $("#addBookModal").find('input').val('');
                }
            }
            else{
                alert("你还未填写任何信息，请添加");
                event.stopPropagation();
            }
        })

        $("#btn_add").click(function(){
            console.log('add');
            $("#addBook").modal()
        });

        //编辑一项校友信息
        $('#btn_edit').click(function () {
            if (table.rows('.selected').data().length) {
                $("#editBookInfo").modal();
                var rowData = table.rows('.selected').data()[0];
                var inputs = $("#editBookModal").find('input');
                for (var i = 0; i < inputs.length; i++) {
                    $(inputs[i]).val(rowData[i + 1])
                }
            } else {
                alert('请选择项目');
            }
        });

        $("#saveEdit").click(function() {
            var editUserName = $("#editUserName").val();

            var editUserGender = $("#editUserGender").val();
            var editUserEducation = $("#editUserEducation").val();
            var editUserBirthPlace = $("#editUserBirthPlace").val();
            var editUserGrade = $("#editUserGrade").val();
            var editUserMajor = $("#editUserMajor").val();
            var editUserGraduateYear = $("#editUserGraduateYear").val();
            var editHeadTeacher = $("#editHeadTeacher").val();
            var editUserMail = $("#editUserMail").val();
            var editUserCompany = $("#editUserCompany").val();
            var editUserPosition = $("#editUserPosition").val();
            var editUserAddress = $("#editUserAddress").val();
            var editUserContact = $("#editUserContact").val();
            var userId = table.rows('.selected').data()[0][0];
            $.ajax({
                url:BASE_PATH + "/user/editUserByUserId",
                type: "post",
                dateType: "json",
                async: false,
                data: {"userId":userId
                    ,"userName":editUserName
                    ,"userGender":editUserGender
                    ,"userEducation":editUserEducation
                    ,"userBirthPlace":editUserBirthPlace
                    ,"userGrade":editUserGrade
                    ,"userMajor":editUserMajor
                    ,"userGraduateYear":editUserGraduateYear
                    ,"userHeadTeacher":editHeadTeacher
                    ,"userMail":editUserMail
                    ,"userCompany":editUserCompany
                    ,"userPosition":editUserPosition
                    ,"userAddress":editUserAddress
                    ,"phone":editUserContact
                },
                success: function f(data) {
                    console.log(data);
                },
                error: function f(data) {
                    alert("lose");
                }
            });
            var newRowData = [].concat(editUserName
                , editUserGender
                , editUserEducation
                , editUserBirthPlace
                , editUserGrade
                , editUserMajor
                , editUserGraduateYear
                , editHeadTeacher
                , editUserMail
                , editUserCompany
                , editUserPosition
                , editUserAddress
                , editUserContact);
            var tds = Array.prototype.slice.call($('.selected td'))
            for (var i = 0; i < newRowData.length; i++) {
                if (newRowData[i] !== '') {
                    tds[i + 1].innerHTML = newRowData[i];
                } else {
                    alert(titles[i] + '内容不能为空')
                }
            }
        })

        $("#cancelEdit").click(function() {
            console.log('cancelAdd');
            $("#editBookModal").find('input').val('')
        })


        //删除一项
        $('#btn_delete').click(function () {
            if (table.rows('.selected').data().length) {
                $("#deleteBook").modal()
            } else {
                alert('请选择项目');
            }
        });

        $('#delete').click(function () {
            var userId = table.rows('.selected').data()[0][0];
            $.ajax({
                url:BASE_PATH + "/user/deleteUserByUserId",
                type: "post",
                dateType: "json",
                async: false,
                data: {"userId":userId},
                success: function f(data) {
                    console.log(data);
                },
                error: function f(data) {
                    alert("lose");
                }
            });
            table.row('.selected').remove().draw(false);
        });

    })


    function bt(){
        var grade = $("#gradeSelected").val();
        var major = $("#majorSelected").val();
        var gender = $("#genderSelected").val();
        if(grade == "请选择"){
            grade = "全体";
        }
        if(major == "请选择"){
            major = "全体";
        }
        if(gender == "请选择"){
            gender = "全体"
        }
        var BASE_PATH = window.document.location.href.substring(0, window.document.location.href.indexOf(window.document.location.pathname));

        window.open(BASE_PATH+"/excel/orderrdExportExcel?grade="+grade+"&major="+major+"&gender="+gender);
    }


    $("#searchByconidition").on("click",function () {
        var grade = $("#gradeSelected").val();
        var major = $("#majorSelected").val();
        var gender = $("#genderSelected").val();
        postData(grade,major, gender);
    });

    function postData(grade, major, gender){
        //获取basePath，测试的话就能用就完了
        var obj = window.document.location;
        var BASE_PATH = obj.href.substring(0, obj.href.indexOf(obj.pathname));
        if(grade == "请选择"){
            grade = "全体";
        }
        if(major == "请选择"){
            major = "全体";
        }
        if(gender == "请选择"){
            gender = "全体"
        }
        var result = new Array();  //先声明一维
        $.ajax({
            url: BASE_PATH + "/user/selectByGrade",
            type: "post",
            dateType: "json",
            data: {"grade":grade,"major":major,"gender":gender},
            async: false,
            success: function f(data) {
                for(var k=0;k<data.length;k++){    //一维长度为i,i为变量，可以根据实际情况改变

                    result[k]=new Array();  //声明二维，每一个一维数组里面的一个元素都是一个数组；

                    for(var j=0;j<14;j++){   //一维数组里面每个元素数组可以包含的数量p，p也是一个变量；

                        result[k][j]="";    //这里将变量初始化，我这边统一初始化为空，后面在用所需的值覆盖里面的值
                    }
                }
                for(var i=0;i<data.length;i++){
                    result[i][0]=data[i].userId;
                    result[i][1]=data[i].userName;
                    result[i][2]=data[i].userGender;
                    result[i][3]=data[i].userEducation;
                    result[i][4]=data[i].userBirthPlace;
                    result[i][5]=data[i].userGrade;
                    result[i][6]=data[i].userMajor;
                    result[i][7]=data[i].userGraduateYear;
                    result[i][8]=data[i].userHeadTeacher;
                    result[i][9]=data[i].userMail;
                    result[i][10]=data[i].userCompany;
                    result[i][11]=data[i].userPosition;
                    result[i][12]=data[i].userAddress;
                    result[i][13]=data[i].phone;
                }
            },
            error: function f(data) {
                alert("lose");
            }
        });
        $("#books").dataTable().fnDestroy();
        var titles = ['序号','姓名', '性别', '学历', '籍贯', '年级','专业', '毕业年份', '班主任', '邮箱', '工作单位','工作职位','工作地点','联系方式']
        var table = $('#books').DataTable({
            data: result,
            "pagingType": "full_numbers",
            "bSort": true,
            "language": {
                "sProcessing": "处理中...",
                "sLengthMenu": "显示 _MENU_ 项结果",
                "sZeroRecords": "没有匹配结果",
                "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                "sInfoPostFix": "",
                "sSearch": "搜索:",
                "sUrl": "",
                "sEmptyTable": "表中数据为空",
                "sLoadingRecords": "载入中...",
                "sInfoThousands": ",",
                "oPaginate": {
                    "sFirst": "首页",
                    "sPrevious": "上页",
                    "sNext": "下页",
                    "sLast": "末页"
                },
                "oAria": {
                    "sSortAscending": ": 以升序排列此列",
                    "sSortDescending": ": 以降序排列此列"
                }
            },
            "columnDefs": [{
                "searchable": false,
                "orderable": true,
                "targets": 0
            }],
            "order": [[1, 'asc']]
        });
        table.on('order.dt search.dt', function() {
            table.column(0, {
                search: 'applied',
                order: 'applied'
            }).nodes().each(function(cell, i) {
                cell.innerHTML = i + 1;
            });
        }).draw();
    }

    /**
     * 验证工作
     *
     * */

    //邮箱格式限定
    function checkMail(myemail) {
        var myReg = /^[a-zA-Z0-9_-]+@([a-zA-Z0-9]+\.)+(com|cn|net|org)$/;

        if (myReg.test(myemail)) {
            return true;
        } else {
            return false;
        }
    }

    //手机号码格式
    function phoneCheck(obj){
        var reg=/^[1][3,4,5,7,8][0-9]{9}$/;
        if(!reg.test(obj)) {
            return false;
        }
        else{
            return true;
        }
    }
</script>
</body>

</html>